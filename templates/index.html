<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Client API REST pour tester vos API, visualiser les r√©sultats et g√©rer l'historique">
    <meta name="theme-color" content="#667eea">
    <title>API REST Client</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üåê API REST Client</h1>
            <p>Testez vos API REST et consultez l'historique de vos requ√™tes</p>
        </header>

        <!-- Dashboard -->
        <section class="dashboard-section">
            <h2>üìä Dashboard</h2>
            <div class="dashboard-grid">
                <!-- √âtat du service -->
                <div class="dashboard-card">
                    <div class="card-icon">üü¢</div>
                    <div class="card-content">
                        <h3>√âtat du Service</h3>
                        <p class="card-value" id="health-status">Chargement...</p>
                        <span class="card-label">Base de donn√©es & API</span>
                    </div>
                </div>

                <!-- Total de requ√™tes -->
                <div class="dashboard-card">
                    <div class="card-icon">üìù</div>
                    <div class="card-content">
                        <h3>Total Requ√™tes</h3>
                        <p class="card-value" id="total-requests">0</p>
                        <span class="card-label">Toutes m√©thodes confondues</span>
                    </div>
                </div>

                <!-- Requ√™tes 24h -->
                <div class="dashboard-card">
                    <div class="card-icon">‚è∞</div>
                    <div class="card-content">
                        <h3>Derni√®res 24h</h3>
                        <p class="card-value" id="recent-requests">0</p>
                        <span class="card-label">Requ√™tes r√©centes</span>
                    </div>
                </div>

                <!-- Temps de r√©ponse moyen -->
                <div class="dashboard-card">
                    <div class="card-icon">‚ö°</div>
                    <div class="card-content">
                        <h3>Temps Moyen</h3>
                        <p class="card-value" id="avg-response-time">0s</p>
                        <span class="card-label">R√©ponse moyenne</span>
                    </div>
                </div>
            </div>

            <!-- Statistiques par m√©thode -->
            <div class="methods-stats">
                <h3>R√©partition par M√©thode HTTP</h3>
                <div class="methods-grid">
                    <div class="method-stat method-stat-get">
                        <span class="method-name">GET</span>
                        <span class="method-count" id="method-GET">0</span>
                    </div>
                    <div class="method-stat method-stat-post">
                        <span class="method-name">POST</span>
                        <span class="method-count" id="method-POST">0</span>
                    </div>
                    <div class="method-stat method-stat-put">
                        <span class="method-name">PUT</span>
                        <span class="method-count" id="method-PUT">0</span>
                    </div>
                    <div class="method-stat method-stat-delete">
                        <span class="method-name">DELETE</span>
                        <span class="method-count" id="method-DELETE">0</span>
                    </div>
                    <div class="method-stat method-stat-patch">
                        <span class="method-name">PATCH</span>
                        <span class="method-count" id="method-PATCH">0</span>
                    </div>
                </div>
            </div>

            <!-- Liens rapides -->
            <div class="quick-links">
                <a href="/api/docs" class="quick-link" target="_blank">
                    <span class="link-icon">üìñ</span>
                    <span class="link-text">Documentation Swagger</span>
                </a>
                <a href="/health" class="quick-link" target="_blank">
                    <span class="link-icon">üè•</span>
                    <span class="link-text">Health Check</span>
                </a>
            </div>
        </section>

        <div class="main-content">
            <!-- Section de requ√™te -->
            <section class="request-section">
                <h2>Nouvelle Requ√™te</h2>
                
                <form id="api-form">
                    <div class="form-group">
                        <label for="method">M√©thode HTTP</label>
                        <select id="method" name="method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="url">URL</label>
                        <input type="text" id="url" name="url" placeholder="https://api.example.com/endpoint" required>
                    </div>

                    <div class="form-group">
                        <label for="headers">Headers (JSON optionnel)</label>
                        <textarea id="headers" name="headers" rows="3" placeholder='{"Content-Type": "application/json", "Authorization": "Bearer token"}'></textarea>
                    </div>

                    <div class="form-group">
                        <label for="proxy">
                            Proxy (optionnel)
                            <span style="font-size: 0.85rem; color: #7f8c8d; font-weight: normal;">
                                Format: http://user:pass@host:port ou http://host:port
                            </span>
                        </label>
                        <input type="text" id="proxy" name="proxy" placeholder="http://proxy.example.com:8080">
                    </div>

                    <div class="form-group" id="body-group">
                        <label for="body">Body (JSON)</label>
                        <textarea id="body" name="body" rows="6" placeholder='{"key": "value"}'></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <span class="btn-text">Envoyer la requ√™te</span>
                            <span class="btn-loading" style="display: none;">‚è≥ Chargement...</span>
                        </button>
                        <button type="button" class="btn btn-secondary" id="clear-btn">Effacer</button>
                    </div>
                </form>

                <!-- Zone de r√©sultats -->
                <div id="response-section" style="display: none;">
                    <h3>R√©sultat</h3>
                    <div class="response-info">
                        <div class="status-badge" id="status-badge"></div>
                        <div class="response-time" id="response-time"></div>
                    </div>
                    <div class="response-tabs">
                        <button class="tab-btn active" data-tab="body">Body</button>
                        <button class="tab-btn" data-tab="headers">Headers</button>
                    </div>
                    <div class="tab-content active" id="body-tab">
                        <pre id="response-body"></pre>
                    </div>
                    <div class="tab-content" id="headers-tab">
                        <pre id="response-headers"></pre>
                    </div>
                </div>
            </section>

            <!-- Section historique -->
            <section class="history-section">
                <div class="history-header">
                    <h2>üìú Historique</h2>
                    <button class="btn btn-small" id="refresh-history">üîÑ Actualiser</button>
                </div>
                
                <div id="history-list" class="history-list">
                    <div class="loading">Chargement de l'historique...</div>
                </div>
            </section>
        </div>
    </div>

    <!-- Exemples d'API -->
    <div class="examples-section">
        <h3>üí° Exemples d'API √† tester</h3>
        <div class="examples-grid">
            <div class="example-card" data-url="https://jsonplaceholder.typicode.com/posts" data-method="GET">
                <strong>JSONPlaceholder</strong>
                <span>Posts (GET)</span>
            </div>
            <div class="example-card" data-url="https://randomuser.me/api/" data-method="GET">
                <strong>Random User</strong>
                <span>User data (GET)</span>
            </div>
            <div class="example-card" data-url="https://dog.ceo/api/breeds/image/random" data-method="GET">
                <strong>Dog API</strong>
                <span>Random dog (GET)</span>
            </div>
            <div class="example-card" data-url="https://api.github.com/users/github" data-method="GET">
                <strong>GitHub API</strong>
                <span>User info (GET)</span>
            </div>
        </div>
    </div>

    <footer>
        <p>Cr√©√© avec Python Flask | ¬© 2025</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
